<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>t5e3_formulario2</title>

  <style>
    label {
      display: inline-block;
      width: 180px;
      margin-top: 8px;
      color: #222;
    }

    input, select, button {
      margin-top: 8px;
      padding: 6px;
    }

    .error-borde {
      border: 2px solid red !important;
      outline: none;
    }

    .error-label {
      color: red !important;
      font-weight: 600;
    }
  </style>
</head>

<body>
  <form action="#" method="post" id="formDiscos">
    <h2>Alta de Discos</h2>

    <label for="nombre" id="lblNombre">Nombre del disco</label>
    <input type="text" id="nombre" name="nombre">
    <br>

    <label for="grupo" id="lblGrupo">Grupo o cantante</label>
    <input type="text" id="grupo" name="grupo">
    <br>

    <label for="año" id="lblAnio">Año de publicación</label>
    <input type="number" id="año" name="año">
    <br>

    <label for="tipo">Tipo de música</label>
    <select id="tipo" name="tipo">
      <option value=""> Selecciona un tipo </option>
      <option value="rock">Rock</option>
      <option value="pop">Pop</option>
      <option value="punk">Punk</option>
      <option value="indie">Indie</option>
    </select>
    <br>

    <label for="localizacion" id="lblLocalizacion">Número de estantería</label>
    <input type="number" id="localizacion" name="localizacion">
    <br>

    <label>
      <input type="checkbox" name="prestado" value="true" class="checkbox">
      Prestado
    </label>
    <br><br>

    <button type="submit">Guardar disco</button>
  </form>

  <script>
    window.onload = function () {
      const form = document.getElementById("formDiscos");

      form.addEventListener("submit", validarFormulario);
      document.getElementById("nombre").addEventListener("input", () => campo20());
      document.getElementById("grupo").addEventListener("input", () => campo20());
      document.getElementById("año").addEventListener("input", () => validarAnio());
      document.getElementById("localizacion").addEventListener("input", () => validarLocalizacion());
    };

  function validarFormulario(event) {
    let ok = true;

    const nombre = document.getElementById("nombre");
    const grupo = document.getElementById("grupo");

    const lblNombre = document.getElementById("lblNombre");
    const lblGrupo = document.getElementById("lblGrupo");

    if (!campo20(nombre, lblNombre)) ok = false;
    if (!campo20(grupo, lblGrupo)) ok = false;

    if (!validarAnio()) ok = false;
    if (!validarLocalizacion()) ok = false;

    if (!ok) {
      event.preventDefault();
    }
  }

  function campo20(input, label) {
    const valor = input.value.trim();

    if (valor.length === 0 || valor.length > 20) {
      marcarError(input, label);
      return false;
    } else {
      limpiarError(input, label);
      return true;
    }
  }


    function validarAnio() {
      const anio = document.getElementById("año");
      const lblAnio = document.getElementById("lblAnio");

      const valor = anio.value.trim();

      const ok = /^[0-9]{4}$/.test(valor);

      if (!ok) marcarError(anio, lblAnio);
      else limpiarError(anio, lblAnio);

      return ok;
    }

    function validarLocalizacion() {
      const loc = document.getElementById("localizacion");
      const lblLoc = document.getElementById("lblLocalizacion");

      const valor = loc.value.trim();

      if (valor === "") {
        limpiarError(loc, lblLoc);
        return true;
      }

      const ok = /^[0-9]+$/.test(valor);

      if (!ok) marcarError(loc, lblLoc);
      else limpiarError(loc, lblLoc);

      return ok;
    }

    function marcarError(input, label) {
      input.classList.add("error-borde");
      if (label) label.classList.add("error-label");
    }

    function limpiarError(input, label) {
      input.classList.remove("error-borde");
      if (label) label.classList.remove("error-label");
    }
  </script>
</body>
</html>
